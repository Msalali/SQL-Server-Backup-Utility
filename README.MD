# SQL Server Backup & LogFile Script

PowerShell script to **backup a SQL Server database**, generate a **LogFile of database size and objects**, verify the backup, and export a **log file** with detailed information.

## ğŸ“‹ Features

- Connects to SQL Server using **Windows Authentication** or **SQL Server Login**.
- Executes the stored procedure `dbo.GetDatabaseSizeReport` to collect database object sizes.
- Creates a `.bak` backup file of the specified database.
- Verifies backup integrity using `RESTORE VERIFYONLY`.
- Generates a log file (`.txt`) containing:
  - SQL Server version, edition, and level
  - Object size LogFile (tables, indexes, total size, etc.)
  - Backup status, size, and verification result
- Automatically installs the `SqlServer` PowerShell module if it's not already available.

---

## ğŸ› ï¸ How to Use

### 1. Open PowerShell as Administrator

(Optional but recommended for module installation)

Set execution policy for the session:

```powershell
Set-ExecutionPolicy -Scope Process -ExecutionPolicy Bypass -Force
```

### 2. Run the Script

Execute the script:

```powershell
CD Path dirctory script
.\backup_script.ps1
```

You will be prompted to enter the following:

- **Server Name** (e.g., `localhost`, `127.0.0.1`, or `ServerName\Instance`)
- **Database Name** to back up
- **Backup Folder Path** (where `.bak` and `.txt` files will be saved)
- **Authentication Method**: Press `Y` for Windows Authentication or `N` for SQL Login (will prompt for credentials)

---

## ğŸ“„ Output

Two files will be generated in the specified directory:

1. **Database Backup File**  
   Format: `YourDatabase_Backup_yyyyMMdd_HHmmss.bak`

2. **Log LogFile File**  
   Format: `LogFileBackup_YourDatabase_yyyyMMdd_HHmmss.txt`  
   Includes:
   - SQL Server details
   - Table/index/object sizes
   - Backup file size and verification status
   - Timestamp and execution notes

---

## ğŸ“Œ Requirements

- PowerShell 5.1 or newer
- `SqlServer` module (installed automatically if missing)
- Stored Procedure `dbo.GetDatabaseSizeReport` must exist in the target database  


---

## âœ… Example Output in Log File

```text
SQL Server Info:-
 - Version        : 15.0.2000.5
 - Edition        : Developer Edition
 - Product Level  : RTM

--------------------------------------------
Objects Include:-
Database_Name Date_Report Object_Name  Object_Type Total_Rows Size (MB)
------------- ------------ ------------ ------------ ----------- ----------
MyDB          2025-05-18   Customers     Table        100000     25.3
MyDB          2025-05-18   Orders        Table        250000     47.9
MyDB          2025-05-18   DB Total      DB Total     N/A        73.2

--------------------------------------------
Backup Info:-
 - Backup Date    : 2025-05-18 15:30:21
 - Backup Size    : 75.65 MB
 - Status         : Completed
 - Verify Status  : Passed

--------------------------------------------
Dev Script By Meshary alali (:
--------------------------------------------
```



---

## ğŸ‘¨â€ğŸ’» Devloper

****  

 [Meshary Alali](https://github.com/msalali)

 [LICENSE](https://github.com/Msalali/BackupScript/blob/main/LICENSE)

---




# Ø³ÙƒØ±Ø¨Øª Ø§Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠ Ø§Ù„Ù…ØªÙ‚Ø¯Ù… Ù„Ù‚Ø§Ø¹Ø¯Ø© Ø¨ÙŠØ§Ù†Ø§Øª SQL Server

Ø³ÙƒØ±ÙŠØ¨Øª PowerShell ÙŠÙ‚ÙˆÙ… Ø¨Ø¹Ù…Ù„ **Ù†Ø³Ø®Ø© Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© Ù„Ù‚Ø§Ø¹Ø¯Ø© Ø¨ÙŠØ§Ù†Ø§Øª SQL Server**ØŒ ÙˆÙŠÙˆÙ„Ù‘Ø¯ **ØªÙ‚Ø±ÙŠØ±Ù‹Ø§ Ø¨Ø­Ø¬Ù… Ø§Ù„ÙƒØ§Ø¦Ù†Ø§Øª Ø¯Ø§Ø®Ù„ Ø§Ù„Ù‚Ø§Ø¹Ø¯Ø©**ØŒ ÙˆÙŠØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø§Ù„Ù†Ø³Ø®Ø©ØŒ ÙˆÙŠÙˆÙ„Ù‘Ø¯ **Ù…Ù„Ù Ø³Ø¬Ù„** ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ ÙƒØ§ÙØ© Ø§Ù„ØªÙØ§ØµÙŠÙ„.

## ğŸ“‹ Ø§Ù„Ù…ÙŠØ²Ø§Øª

- Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù€ SQL Server Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… **Ù…ØµØ§Ø¯Ù‚Ø© ÙˆÙŠÙ†Ø¯ÙˆØ²** Ø£Ùˆ **ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ SQL Server**.
- ØªÙ†ÙÙŠØ° Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡ Ø§Ù„Ù…Ø®Ø²Ù† `dbo.GetDatabaseSizeReport` Ù„Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø£Ø­Ø¬Ø§Ù… Ø§Ù„ÙƒØ§Ø¦Ù†Ø§Øª.
- Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù„Ù Ù†Ø³Ø®Ø© Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© Ø¨Ø§Ù…ØªØ¯Ø§Ø¯ `.bak`.
- Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… `RESTORE VERIFYONLY`.
- ØªÙˆÙ„ÙŠØ¯ Ù…Ù„Ù Ø³Ø¬Ù„ (`.txt`) ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰:
  - Ø¥ØµØ¯Ø§Ø± SQL Server ÙˆØ§Ù„Ù…Ø³ØªÙˆÙ‰ ÙˆØ§Ù„Ù†ÙˆØ¹
  - ØªÙ‚Ø±ÙŠØ± ØªÙØµÙŠÙ„ÙŠ Ø¹Ù† Ø§Ù„ÙƒØ§Ø¦Ù†Ø§Øª (Ø¬Ø¯Ø§ÙˆÙ„ØŒ ÙÙ‡Ø§Ø±Ø³ØŒ Ø§Ù„Ø­Ø¬Ù… Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØŒ ...)
  - Ø­Ø§Ù„Ø© Ø§Ù„Ù†Ø³Ø® ÙˆØ­Ø¬Ù… Ø§Ù„Ù…Ù„Ù ÙˆÙ†ØªÙŠØ¬Ø© Ø§Ù„ØªØ­Ù‚Ù‚
- ØªØ«Ø¨ÙŠØª ÙˆØ­Ø¯Ø© PowerShell `SqlServer` ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§ ÙÙŠ Ø­Ø§Ù„ Ø¹Ø¯Ù… ØªÙˆÙØ±Ù‡Ø§.

---

## ğŸ› ï¸ Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…

### 1. Ø§ÙØªØ­ PowerShell ÙƒÙ…Ø³Ø¤ÙˆÙ„

(Ø§Ø®ØªÙŠØ§Ø±ÙŠ Ù„ÙƒÙ† ÙŠÙÙØ¶Ù„ Ù„ØªÙØ§Ø¯ÙŠ Ù…Ø´Ø§ÙƒÙ„ Ø§Ù„ØªØµØ§Ø±ÙŠØ­)

Ù‚Ù… Ø¨ØªØ¹ÙŠÙŠÙ† Ø³ÙŠØ§Ø³Ø© Ø§Ù„ØªÙ†ÙÙŠØ° Ù„Ù„Ø¬Ù„Ø³Ø©:

```powershell
Set-ExecutionPolicy -Scope Process -ExecutionPolicy Bypass -Force
```

### 2. ØªØ´ØºÙŠÙ„ Ø§Ù„Ø³ÙƒØ±Ø¨Øª

Ù‚Ù… Ø¨ØªØ´ØºÙŠÙ„ Ø§Ù„Ø³ÙƒØ±Ø¨Øª:

```powershell
CD Path dirctory script
.\backup_script.ps1

```

Ø³ÙŠÙØ·Ù„Ø¨ Ù…Ù†Ùƒ Ø¥Ø¯Ø®Ø§Ù„ Ù…Ø§ ÙŠÙ„ÙŠ:

- **Ø§Ø³Ù… Ø§Ù„Ø®Ø§Ø¯Ù…** (Ù…Ø«Ù„: `localhost` Ø£Ùˆ `127.0.0.1` Ø£Ùˆ `ServerName\Instance`)
- **Ø§Ø³Ù… Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª** Ø§Ù„ØªÙŠ ØªØ±ØºØ¨ Ø¨Ø¹Ù…Ù„ Ù†Ø³Ø®Ø© Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© Ù„Ù‡Ø§
- **Ù…Ø³Ø§Ø± Ø­ÙØ¸ Ø§Ù„Ù†Ø³Ø®Ø©** (Ø­ÙŠØ« Ø³ÙŠØªÙ… Ø­ÙØ¸ Ù…Ù„ÙØ§Øª `.bak` Ùˆ`.txt`)
- **Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©**: Ø§Ø¶ØºØ· `Y` Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…ØµØ§Ø¯Ù‚Ø© ÙˆÙŠÙ†Ø¯ÙˆØ² Ø£Ùˆ `N` Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ SQL (ÙˆØ³ÙŠØ·Ù„Ø¨ Ù…Ù†Ùƒ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„)

---

## ğŸ“„ Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ù†Ø§ØªØ¬Ø©

ÙŠØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù„ÙÙŠÙ† ÙÙŠ Ø§Ù„Ù…Ø³Ø§Ø± Ø§Ù„Ø°ÙŠ Ø­Ø¯Ø¯ØªÙ‡:

1. **Ù…Ù„Ù Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©**  
   Ø§Ù„ØµÙŠØºØ©: `YourDatabase_Backup_yyyyMMdd_HHmmss.bak`

2. **Ù…Ù„Ù Ø§Ù„Ø³Ø¬Ù„ Ø§Ù„Ù†ØµÙŠ**  
   Ø§Ù„ØµÙŠØºØ©: `LogFileBackup_YourDatabase_yyyyMMdd_HHmmss.txt`  
   ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰:
   - ØªÙØ§ØµÙŠÙ„ SQL Server
   - ØªÙ‚Ø±ÙŠØ± Ø­Ø¬Ù… Ø§Ù„ÙƒØ§Ø¦Ù†Ø§Øª
   - Ø­Ø¬Ù… Ø§Ù„Ù†Ø³Ø®Ø© ÙˆØ­Ø§Ù„Ø© Ø§Ù„ØªØ­Ù‚Ù‚
   - Ø§Ù„ÙˆÙ‚Øª ÙˆØªÙØ§ØµÙŠÙ„ Ø§Ù„ØªØ´ØºÙŠÙ„

---

## ğŸ“Œ Ø§Ù„Ù…ØªØ·Ù„Ø¨Ø§Øª

- PowerShell 5.1 Ø£Ùˆ Ø£Ø­Ø¯Ø«
- ÙˆØ­Ø¯Ø© `SqlServer` (ÙŠØªÙ… ØªØ«Ø¨ÙŠØªÙ‡Ø§ ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§ Ø¥Ù† Ù„Ù… ØªÙƒÙ† Ù…ØªÙˆÙØ±Ø©)
- Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡ Ø§Ù„Ù…Ø®Ø²Ù† `dbo.GetDatabaseSizeReport` ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ù…ÙˆØ¬ÙˆØ¯Ù‹Ø§ Ø¯Ø§Ø®Ù„ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª  

---

## âœ… Ù…Ø«Ø§Ù„ Ø¹Ù„Ù‰ Ø§Ù„Ø¥Ø®Ø±Ø§Ø¬ Ø¯Ø§Ø®Ù„ Ù…Ù„Ù Ø§Ù„Ø³Ø¬Ù„

```text
SQL Server Info:-
 - Version        : 15.0.2000.5
 - Edition        : Developer Edition
 - Product Level  : RTM

--------------------------------------------
Objects Include:-
Database_Name Date_Report Object_Name  Object_Type Total_Rows Size (MB)
------------- ------------ ------------ ------------ ----------- ----------
MyDB          2025-05-18   Customers     Table        100000     25.3
MyDB          2025-05-18   Orders        Table        250000     47.9
MyDB          2025-05-18   DB Total      DB Total     N/A        73.2

--------------------------------------------
Backup Info:-
 - Backup Date    : 2025-05-18 15:30:21
 - Backup Size    : 75.65 MB
 - Status         : Completed
 - Verify Status  : Passed

--------------------------------------------
Dev Script By Meshary alali (:
--------------------------------------------
```

---

## ğŸ‘¨â€ğŸ’» Ø§Ù„Ù…Ø·ÙˆØ±


 [Ù…Ø´Ø§Ø±ÙŠ Ø§Ù„Ø¹Ù„ÙŠ](https://github.com/msalali)

[Ø§Ù„ØªØ±Ø®ÙŠØµ](https://github.com/Msalali/BackupScript/blob/main/LICENSE)

---



